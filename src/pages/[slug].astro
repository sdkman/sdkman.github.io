---
import PageHeader from '@/components/PageHeader.astro';
import Link from '@/components/ui/Link.astro';
import Note from '@/components/ui/Note.astro';
import DocsLayout from '@/layouts/DocsLayout.astro';
import { getCollection, getEntry, render } from 'astro:content';

export async function getStaticPaths() {
  const allDocs = await getCollection('docs');

  return allDocs.map((doc: { id: string }) => ({ params: { slug: doc.id } }));
}

const { slug } = Astro.params;

const doc = await getEntry('docs', slug);

if (!doc) {
  throw Error('Not Found');
}

const { Content, headings } = await render(doc);
---

<DocsLayout title={doc.data.title} headings={headings}>
  <Content components={{ a: Link, Note, PageHeader }} />
</DocsLayout>
